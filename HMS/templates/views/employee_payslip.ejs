<!DOCTYPE html>
<html lang="en">
<%- include('includes/head') %>

<body>
  <%- include('includes/navbar') %>

  <section class="main">
    <!-- Employee Payslip content -->
    <div class="payroll-content">
      <div class="container-fluid p-3 bg-white rounded-2">
        <div class="close_lab_report text-end m-3 d-inline float-end">
          <a href="/admin/payroll/generate"><i class="fa-solid fa-xmark text-secondary"></i></a>
        </div>

        <div id="printable-content" class="container p-4 col-xl-6 mt-lg-4 mb-lg-4 border">
          <div class="row">
            <div class="col-md-12">
              <div class="text-center lh-1 mb-2">
                <h4 class="fw-bold text-decoration-underline">PAYSLIP</h4>
              </div>
              <br />
              <div class="row">
                <div class="col-12">
                  <div class="row">
                    <div class="col-12">
                      <div>
                        <span class="fw-bolder">EMP ID</span>
                        <small class="ms-3"><%= employee.employee_id %></small>
                      </div>
                    </div>
                    <div class="col-12">
                      <div>
                        <span class="fw-bolder">EMP Name</span>
                        <small class="ms-3"><%= employee.full_name %></small>
                      </div>
                    </div>
                  </div>
                  <div class="row">
                    <div class="col-12">
                      <div>
                        <span class="fw-bolder">Designation</span>
                        <small class="ms-3"><%= employee.position %></small>
                      </div>
                    </div>
                  </div>
                  <div class="row">
                    <div class="col-12">
                      <div>
                        <span class="fw-bolder">PF No.</span>
                        <small class="ms-3">101523065714</small>
                      </div>
                    </div>
                  </div>
                  <div class="row">
                    <div class="col-12">
                      <div>
                        <span class="fw-bolder">ESI No.</span>
                        <small class="ms-3">----</small>
                      </div>
                    </div>
                    <div class="col-12">
                      <div>
                        <span class="fw-bolder">Mode of Pay</span>
                        <small class="ms-3">Fast Transfer</small>
                      </div>
                    </div>
                    <div class="col-12">
                      <div>
                        <span class="fw-bolder">Ac No.</span>
                        <small class="ms-3">*******0701</small>
                      </div>
                    </div>
                  </div>
                </div>
                <table class="mt-4 table table-bordered">
                  <thead class="bg-dark text-white">
                    <tr>
                      <th scope="col">Earnings</th>
                      <th scope="col">Amount</th>
                      <th scope="col">Deductions</th>
                      <th scope="col">Amount</th>
                    </tr>
                  </thead>
                  <tbody>
                    <tr>
                      <th scope="row">Basic</th>
                      <td><%= Number(employee.salary) - 9720 + ".00" %></td>
                      <td>PF</td>
                      <td>1800.00</td>
                    </tr>
                    <tr>
                      <th scope="row">DA</th>
                      <td>550.00</td>
                      <td>ESI</td>
                      <td>142.00</td>
                    </tr>
                    <tr>
                      <th scope="row">HRA</th>
                      <td>1650.00</td>
                      <td>TDS</td>
                      <td>0.00</td>
                    </tr>
                    <tr>
                      <th scope="row">WA</th>
                      <td>120.00</td>
                      <td>LOP</td>
                      <td>0.00</td>
                    </tr>
                    <tr>
                      <th scope="row">CA</th>
                      <td>0.00</td>
                      <td>PT</td>
                      <td>0.00</td>
                    </tr>
                    <tr>
                      <th scope="row">CCA</th>
                      <td>0.00</td>
                      <td>SPL. Deduction</td>
                      <td>500.00</td>
                    </tr>
                    <tr>
                      <th scope="row">MA</th>
                      <td>3000.00</td>
                      <td>EWF</td>
                      <td>0.00</td>
                    </tr>
                    <tr>
                      <th scope="row">Sales Incentive</th>
                      <td>0.00</td>
                      <td>CD</td>
                      <td>0.00</td>
                    </tr>
                    <tr>
                      <th scope="row">Leave Encashment</th>
                      <td>0.00</td>
                      <td colspan="2"></td>
                    </tr>
                    <tr>
                      <th scope="row">Holiday Wages</th>
                      <td>500.00</td>
                      <td colspan="2"></td>
                    </tr>
                    <tr>
                      <th scope="row">Special Allowance</th>
                      <td>100.00</td>
                      <td colspan="2"></td>
                    </tr>
                    <tr>
                      <th scope="row">Bonus</th>
                      <td>1400.00</td>
                      <td colspan="2"></td>
                    </tr>
                    <tr>
                      <th scope="row">Individual Incentive</th>
                      <td>2400.00</td>
                      <td colspan="2"></td>
                    </tr>
                    <tr class="border-top">
                      <th scope="row">Total Earning</th>
                      <td><%= Number(employee.salary) + 2442 +".00"; %></td>
                      <td>Total Deductions</td>
                      <td>2442.00</td>
                    </tr>
                  </tbody>
                </table>
              </div>
              <div class="row">
                <div class="col-md-4">
                  <br />
                  <span class="fw-bold">Net Pay : â‚¹
                    <span class="fw-bold fs-4 salary-currency"><%= employee.salary %></span>.00</span>
                </div>
                <p id="word-currency"><i>(In words: <span class="salary-text"></span>)</i></p>
              </div>
            </div>
          </div>
        </div>

        <div class="row">
          <div id="print-button" class="btn btn-success col-1 m-auto">
            <i class="fa-solid fa-print"></i> &nbsp; Print
          </div>
        </div>
      </div>
    </div>
  </section>

  <!-- bootstrap cdn -->
  <script defer src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/js/bootstrap.bundle.min.js" integrity="sha384-YvpcrYf0tY3lHB60NNkmXc5s9fDVZLESaAA55NDzOxhy9GkcIdslK1eN7N6jIeHz" crossorigin="anonymous"></script>

  <!-- Main js file -->
  <script defer src="/js/admin.js"></script>

  <script>
    document.getElementById("print-button").addEventListener("click", function() {
      var printContents = document.getElementById("printable-content").innerHTML;
      var originalContents = document.body.innerHTML;
      var navbar = document.querySelector('.navbar');

      // Hide the navbar for printing
      navbar.style.display = 'none';

      // Update the body content for printing
      document.body.innerHTML = printContents;

      // Print the page
      window.print();

      // Restore the original content after printing
      document.body.innerHTML = originalContents;
      navbar.style.display = ''; // Restore navbar visibility

      // location.reload(); // To re-load any scripts or event listeners lost during print
    });


    //coverts Inr to text
    const num = Number(document.querySelector(".salary-currency").innerText);
    console.log(num);
    const wordify = (num) => {
      const single = ["Zero", "One", "Two", "Three", "Four", "Five", "Six", "Seven", "Eight", "Nine"];
      const double = ["Ten", "Eleven", "Twelve", "Thirteen", "Fourteen", "Fifteen", "Sixteen", "Seventeen", "Eighteen", "Nineteen"];
      const tens = ["", "Ten", "Twenty", "Thirty", "Forty", "Fifty", "Sixty", "Seventy", "Eighty", "Ninety"];
      const formatTenth = (digit, prev) => {
        return 0 == digit ? "" : " " + (1 == digit ? double[prev] : tens[digit])
      };
      const formatOther = (digit, next, denom) => {
        return (0 != digit && 1 != next ? " " + single[digit] : "") + (0 != next || digit > 0 ? " " + denom : "")
      };
      let res = "";
      let index = 0;
      let digit = 0;
      let next = 0;
      let words = [];
      if (num += "", isNaN(parseInt(num))) {
        res = "";
      } else if (parseInt(num) > 0 && num.length <= 10) {
        for (index = num.length - 1; index >= 0; index--) switch (digit = num[index] - 0, next = index > 0 ? num[index - 1] - 0 : 0, num.length - index - 1) {
          case 0:
            words.push(formatOther(digit, next, ""));
            break;
          case 1:
            words.push(formatTenth(digit, num[index + 1]));
            break;
          case 2:
            words.push(0 != digit ? " " + single[digit] + " Hundred" + (0 != num[index + 1] && 0 != num[index + 2] ? " and" : "") : "");
            break;
          case 3:
            words.push(formatOther(digit, next, "Thousand"));
            break;
          case 4:
            words.push(formatTenth(digit, num[index + 1]));
            break;
          case 5:
            words.push(formatOther(digit, next, "Lakh"));
            break;
          case 6:
            words.push(formatTenth(digit, num[index + 1]));
            break;
          case 7:
            words.push(formatOther(digit, next, "Crore"));
            break;
          case 8:
            words.push(formatTenth(digit, num[index + 1]));
            break;
          case 9:
            words.push(0 != digit ? " " + single[digit] + " Hundred" + (0 != num[index + 1] || 0 != num[index + 2] ? " and" : " Crore") : "")
        };
        res = words.reverse().join("")
      } else res = "";
      return res
    };
    document.querySelector(".salary-text").innerText = wordify(num);
  </script>
</body>

</html>